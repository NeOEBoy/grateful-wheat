{"version":3,"sources":["view/Lodop6.226_Clodop4.127/LodopFuncs.js"],"names":["CreatedOKLodopObject","CLodopIsLocal","CLodopJsState","needCLodop","ua","navigator","userAgent","match","verTrident","verIE","verOPR","verFF","x64","verChrome","err","head","document","getElementsByTagName","documentElement","JS1","createElement","JS2","src","onload","onerror","evt","insertBefore","firstChild","loadCLodop","module","exports","getLodop","oOBJECT","oEMBED","LODOP","isIE","window","getCLodop","alert","body","innerHTML","CLODOP","CVERSION","parentNode","removeChild","is64IE","setAttribute","appendChild","VERSION","indexOf"],"mappings":"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","file":"static/js/0.016c0a71.chunk.js","sourcesContent":["//==本JS是加载Lodop插件及CLodop服务的综合示例，可直接使用，建议看懂后融进自己页面程序==\r\n\r\nvar CreatedOKLodopObject, CLodopIsLocal, CLodopJsState;\r\n\r\n//==判断是否需要CLodop(那些不支持插件的浏览器):==\r\nfunction needCLodop() {\r\n    try {\r\n        var ua = navigator.userAgent;\r\n        if (ua.match(/Windows\\sPhone/i))\r\n            return true;\r\n        if (ua.match(/iPhone|iPod|iPad/i))\r\n            return true;\r\n        if (ua.match(/Android/i))\r\n            return true;\r\n        if (ua.match(/Edge\\D?\\d+/i))\r\n            return true;\r\n\r\n        var verTrident = ua.match(/Trident\\D?\\d+/i);\r\n        var verIE = ua.match(/MSIE\\D?\\d+/i);\r\n        var verOPR = ua.match(/OPR\\D?\\d+/i);\r\n        var verFF = ua.match(/Firefox\\D?\\d+/i);\r\n        var x64 = ua.match(/x64/i);\r\n        if ((!verTrident) && (!verIE) && (x64))\r\n            return true;\r\n        else if (verFF) {\r\n            verFF = verFF[0].match(/\\d+/);\r\n            if ((verFF[0] >= 41) || (x64))\r\n                return true;\r\n        } else if (verOPR) {\r\n            verOPR = verOPR[0].match(/\\d+/);\r\n            if (verOPR[0] >= 32)\r\n                return true;\r\n        } else if ((!verTrident) && (!verIE)) {\r\n            var verChrome = ua.match(/Chrome\\D?\\d+/i);\r\n            if (verChrome) {\r\n                verChrome = verChrome[0].match(/\\d+/);\r\n                if (verChrome[0] >= 41)\r\n                    return true;\r\n            }\r\n        }\r\n        return false;\r\n    } catch (err) {\r\n        return true;\r\n    }\r\n}\r\n\r\n//==加载引用CLodop的主JS,用双端口8000和18000(以防其中一个被占):==\r\nfunction loadCLodop() {\r\n    if (CLodopJsState === \"loading\" || CLodopJsState === \"complete\") return;\r\n    CLodopJsState = \"loading\";\r\n    var head = document.head || document.getElementsByTagName(\"head\")[0] || document.documentElement;\r\n    var JS1 = document.createElement(\"script\");\r\n    var JS2 = document.createElement(\"script\");\r\n    JS1.src = \"http://localhost:8000/CLodopfuncs.js?priority=1\";\r\n    JS2.src = \"http://localhost:18000/CLodopfuncs.js\";\r\n    JS1.onload = JS2.onload = function () { CLodopJsState = \"complete\"; }\r\n    JS1.onerror = JS2.onerror = function (evt) { CLodopJsState = \"complete\"; }\r\n    head.insertBefore(JS1, head.firstChild);\r\n    head.insertBefore(JS2, head.firstChild);\r\n    CLodopIsLocal = !!((JS1.src + JS2.src).match(/\\/\\/localho|\\/\\/127.0.0./i));\r\n}\r\n\r\nif (needCLodop()) { loadCLodop(); }//加载\r\n\r\n//==获取LODOP对象主过程,判断是否安装、需否升级:==\r\nfunction getLodop(oOBJECT, oEMBED) {\r\n    var strHtmInstall = \"<br><font color='#FF00FF'>打印控件未安装!点击这里<a href=download/install_lodop32.exe target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>\";\r\n    var strHtmUpdate = \"<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href=download/install_lodop32.exe target='_self'>执行升级</a>,升级后请重新进入。</font>\";\r\n    var strHtm64_Install = \"<br><font color='#FF00FF'>打印控件未安装!点击这里<a href=download/install_lodop64.exe target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>\";\r\n    var strHtm64_Update = \"<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href=download/install_lodop64.exe target='_self'>执行升级</a>,升级后请重新进入。</font>\";\r\n    var strHtmFireFox = \"<br><br><font color='#FF00FF'>（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它）</font>\";\r\n    var strHtmChrome = \"<br><br><font color='#FF00FF'>(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）</font>\";\r\n    var strCLodopInstall_1 = \"<br><font color='#FF00FF'>Web打印服务CLodop未安装启动，点击这里<a href=download/CLodop_Setup_for_Win32NT.exe target='_self'>下载执行安装</a>\";\r\n    var strCLodopInstall_2 = \"<br>（若此前已安装过，可<a href='CLodop.protocol:setup' target='_self'>点这里直接再次启动</a>）\";\r\n    var strCLodopInstall_3 = \"，成功后请刷新本页面。</font>\";\r\n    var strCLodopUpdate = \"<br><font color='#FF00FF'>Web打印服务CLodop需升级!点击这里<a href=download/CLodop_Setup_for_Win32NT.exe target='_self'>执行升级</a>,升级后请刷新页面。</font>\";\r\n    var LODOP;\r\n    try {\r\n        var ua = navigator.userAgent;\r\n        var isIE = !!(ua.match(/MSIE/i)) || !!(ua.match(/Trident/i));\r\n        if (needCLodop()) {\r\n            try {\r\n                LODOP = window.getCLodop();\r\n            } catch (err) { }\r\n            if (!LODOP && CLodopJsState !== \"complete\") {\r\n                if (CLodopJsState === \"loading\") alert(\"网页还没下载完毕，请稍等一下再操作.\"); else alert(\"没有加载CLodop的主js，请先调用loadCLodop过程.\");\r\n                return;\r\n            }\r\n            if (!LODOP) {\r\n                document.body.innerHTML = strCLodopInstall_1 + (CLodopIsLocal ? strCLodopInstall_2 : \"\") + strCLodopInstall_3 + document.body.innerHTML;\r\n                return;\r\n            } else {\r\n                if (window.CLODOP.CVERSION < \"4.1.2.7\") {\r\n                    document.body.innerHTML = strCLodopUpdate + document.body.innerHTML;\r\n                }\r\n                if (oEMBED && oEMBED.parentNode)\r\n                    oEMBED.parentNode.removeChild(oEMBED); //清理旧版无效元素\r\n                if (oOBJECT && oOBJECT.parentNode)\r\n                    oOBJECT.parentNode.removeChild(oOBJECT);\r\n            }\r\n        } else {\r\n            var is64IE = isIE && !!(ua.match(/x64/i));\r\n            //==如果页面有Lodop就直接使用,否则新建:==\r\n            if (oOBJECT || oEMBED) {\r\n                if (isIE)\r\n                    LODOP = oOBJECT;\r\n                else\r\n                    LODOP = oEMBED;\r\n            } else if (!CreatedOKLodopObject) {\r\n                LODOP = document.createElement(\"object\");\r\n                LODOP.setAttribute(\"width\", 0);\r\n                LODOP.setAttribute(\"height\", 0);\r\n                LODOP.setAttribute(\"style\", \"position:absolute;left:0px;top:-100px;width:0px;height:0px;\");\r\n                if (isIE)\r\n                    LODOP.setAttribute(\"classid\", \"clsid:2105C259-1E0C-4534-8141-A753534CB4CA\");\r\n                else\r\n                    LODOP.setAttribute(\"type\", \"application/x-print-lodop\");\r\n                document.documentElement.appendChild(LODOP);\r\n                CreatedOKLodopObject = LODOP;\r\n            } else\r\n                LODOP = CreatedOKLodopObject;\r\n            //==Lodop插件未安装时提示下载地址:==\r\n            if ((!LODOP) || (!LODOP.VERSION)) {\r\n                if (ua.indexOf('Chrome') >= 0)\r\n                    document.body.innerHTML = strHtmChrome + document.body.innerHTML;\r\n                if (ua.indexOf('Firefox') >= 0)\r\n                    document.body.innerHTML = strHtmFireFox + document.body.innerHTML;\r\n                document.body.innerHTML = (is64IE ? strHtm64_Install : strHtmInstall) + document.body.innerHTML;\r\n                return LODOP;\r\n            }\r\n        }\r\n        if (LODOP.VERSION < \"6.2.2.6\") {\r\n            if (!needCLodop())\r\n                document.body.innerHTML = (is64IE ? strHtm64_Update : strHtmUpdate) + document.body.innerHTML;\r\n        }\r\n        //===如下空白位置适合调用统一功能(如注册语句、语言选择等):==\r\n\r\n\r\n        //=======================================================\r\n        return LODOP;\r\n    } catch (err) {\r\n        alert(\"getLodop出错:\" + err);\r\n    }\r\n}\r\n\r\nmodule.exports = { getLodop };\r\n"],"sourceRoot":""}